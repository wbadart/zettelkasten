---
date: 2020-11-09T09:56
---

# Anamorphism

A [recursion scheme](ded70ad5.md) that builds up a recursive structure from a
seed. From the Greek "[ἀνά][wiktionary]" for "building" (e.g. "anabolic"),
"up", or "upon".

[wiktionary]: https://en.wiktionary.org/wiki/%E1%BC%80%CE%BD%CE%AC

```haskell
ana :: (Functor f) => FCoAlgebra f a -> a -> Fix f
ana f = In <<< fmap (ana f) <<< f
```

where

```haskell
type FCoAlgebra f a = a -> f a
newtype Fix f = In { out :: f (Fix f) }
```

Anamorphisms take a F-coalgebra, the dual of [[234411dc]]'s F-algebra.

For example, given:

```haskell
{-# LANGUAGE DeriveFunctor #-}
data ListOfUnit f
  = Cons () f
  | Nil
  deriving Functor
```

we can write:

```haskell
repeatUnits :: Int -> Fix ListOfUnit
repeatUnits n a = ana go n where
  go :: FCoAlgebra ListOfUnit Int
  go 0 = Nil
  go n = Cons () (n - 1)

main = print $ lenUnits (repeatUnits 10)  -- "10"
 where lenUnits = cata $ \x -> case x of
         Nil -> 0
         Cons () rest -> 1 + rest
```

TODO: For the above example, I tried to write `data List a f` but it wasn't
immediately obvious to me how to write the functor instance. Revisit.
